var markDownEditor=CodeMirror.fromTextArea(document.getElementById("codeMarkDown"),{lineNumbers:!0,matchBrackets:!0,mode:"markdown",htmlMode:!0,indentUnit:4,theme:"yonce",lineWrapping:!0}),htmlEditor=CodeMirror.fromTextArea(document.getElementById("codeHtml"),{lineNumbers:!0,matchBrackets:!0,mode:"xml",htmlMode:!0,indentUnit:4,theme:"yonce",readOnly:!0,lineWrapping:!0,cursorBlinkRate:-1});htmlEditor.on("change",function(e){document.getElementById("result").innerHTML=htmlEditor.getValue()}),markDownEditor.on("change",function(e){var t=new showdown.Converter;htmlEditor.setValue(t.makeHtml(markDownEditor.getValue()))});var btnExportMarkdown=document.getElementById("btn-export-markdown");btnExportMarkdown.addEventListener("click",function(){var e=markDownEditor.getValue();if(""!==e.trim()){var t=new Blob([e],{type:"text/plain"}),n=document.createElement("a");n.download="text.md",n.innerHTML="Download File",null!=window.webkitURL?n.href=window.webkitURL.createObjectURL(t):(n.href=window.URL.createObjectURL(t),n.onclick=destroyClickedElement,n.style.display="none",document.body.appendChild(n)),n.click()}else alert("К сожалению, нечего экпортировать.")});var btnExportHtml=document.getElementById("btn-export-html");function destroyClickedElement(e){document.body.removeChild(e.target)}btnExportHtml.addEventListener("click",function(){var e=htmlEditor.getValue();if(""!==e.trim()){var t=new Blob([e],{type:"text/plain"}),n=document.createElement("a");n.download="text.html",n.innerHTML="Download File",null!=window.webkitURL?n.href=window.webkitURL.createObjectURL(t):(n.href=window.URL.createObjectURL(t),n.onclick=destroyClickedElement,n.style.display="none",document.body.appendChild(n)),n.click()}else alert("К сожалению, нечего экпортировать.")});var btnCleanMarkdown=document.getElementById("btn-clean-markdown");btnCleanMarkdown.addEventListener("click",function(){markDownEditor.setValue("")});var btnImportMarkdown=document.getElementById("btn-import-markdown"),inputFile=document.getElementById("input-file");function readFile(e){var t=new FileReader;t.onload=function(e){markDownEditor.setValue(e.target.result)},t.readAsText(e)}btnImportMarkdown.addEventListener("click",function(){inputFile.click()}),inputFile.addEventListener("change",function(e){readFile(e.srcElement.files[0])});var btnLinkMarkdown=document.getElementById("btn-link-markdown"),linkModal=document.querySelector(".add-link"),linkModalClose=document.getElementById("add-link-close"),linkModalOk=document.getElementById("add-link-ok"),linkInput=document.getElementById("input-link");btnLinkMarkdown.addEventListener("click",function(e){e.preventDefault(),linkModal.classList.add("add-link-show"),linkInput.value="",linkInput.focus()}),linkModalClose.addEventListener("click",function(e){e.preventDefault(),linkModal.classList.remove("add-link-show"),linkModal.classList.remove("add-link-error")}),linkModalOk.addEventListener("click",function(e){if(!linkInput.value)return e.preventDefault(),linkModal.classList.remove("add-link-error"),linkModal.offsetWidth=linkModal.offsetWidth,void linkModal.classList.add("add-link-error");var t="[enter link description here]("+linkInput.value+")",n=markDownEditor.getDoc(),d=n.getCursor();n.replaceRange(t,d),linkModal.classList.remove("add-link-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),linkModal.classList.contains("add-link-show")&&(linkModal.classList.remove("add-link-show"),linkModal.classList.remove("add-link-error")))}),window.addEventListener("keydown",function(e){linkModal.classList.contains("add-link-show")&&13===e.keyCode&&(e.preventDefault(),linkModalOk.click())});var btnImgMarkdown=document.getElementById("btn-img-markdown"),imgModal=document.querySelector(".add-img"),imgModalClose=document.getElementById("add-img-close"),imgModalOk=document.getElementById("add-img-ok"),imgInput=document.getElementById("input-img");btnImgMarkdown.addEventListener("click",function(e){e.preventDefault(),imgModal.classList.add("add-img-show"),imgInput.value="",imgInput.focus()}),imgModalClose.addEventListener("click",function(e){e.preventDefault(),imgModal.classList.remove("add-img-show"),imgModal.classList.remove("add-img-error")}),imgModalOk.addEventListener("click",function(e){if(!imgInput.value)return e.preventDefault(),imgModal.classList.remove("add-img-error"),imgModal.offsetWidth=imgModal.offsetWidth,void imgModal.classList.add("add-img-error");var t="![enter img description here]("+imgInput.value+")",n=markDownEditor.getDoc(),d=n.getCursor();n.replaceRange(t,d),imgModal.classList.remove("add-img-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),imgModal.classList.contains("add-img-show")&&(imgModal.classList.remove("add-img-show"),imgModal.classList.remove("add-img-error")))}),window.addEventListener("keydown",function(e){imgModal.classList.contains("add-img-show")&&13===e.keyCode&&(e.preventDefault(),imgModalOk.click())});var linkContacts=document.querySelector(".link-contacts"),contactsModal=document.querySelector(".contacts"),contactsModalClose=document.getElementById("contacts-close");linkContacts.addEventListener("click",function(e){e.preventDefault(),contactsModal.classList.add("contacts-show")}),contactsModalClose.addEventListener("click",function(e){e.preventDefault(),contactsModal.classList.remove("contacts-show")}),window.addEventListener("keydown",function(e){contactsModal.classList.contains("contacts-show")&&27===e.keyCode&&(e.preventDefault(),contactsModalClose.click())});var mode1=document.querySelector(".view__ul--1"),mode2=document.querySelector(".view__ul--2"),mode3=document.querySelector(".view__ul--3"),boxResult=document.getElementById("boxResult"),boxHtml=document.getElementById("boxHtml"),boxMarkdown=document.getElementById("boxMarkdown"),handler1=document.getElementById("handler1"),handler2=document.getElementById("handler2"),mods=[mode1,mode2,mode3],setCurrentMode=function(e,t){e.forEach(function(e){e.classList.contains("current")&&e.classList.remove("current")}),e[t-1].classList.add("current")};mode1.addEventListener("click",function(e){e.preventDefault(),setCurrentMode(mods,1),handler2.classList.contains("visually-hidden")&&handler2.classList.remove("visually-hidden"),boxResult.classList.contains("visually-hidden")&&boxResult.classList.remove("visually-hidden"),handler1.classList.contains("visually-hidden")||handler1.classList.add("visually-hidden"),boxHtml.classList.contains("visually-hidden")||boxHtml.classList.add("visually-hidden"),boxMarkdown.style.width="50%",boxResult.style.width="50%",boxMarkdown.style.height="auto"}),mode2.addEventListener("click",function(e){e.preventDefault(),setCurrentMode(mods,2),handler1.classList.contains("visually-hidden")||handler1.classList.add("visually-hidden"),handler2.classList.contains("visually-hidden")||handler2.classList.add("visually-hidden"),boxHtml.classList.contains("visually-hidden")||boxHtml.classList.add("visually-hidden"),boxResult.classList.contains("visually-hidden")||boxResult.classList.add("visually-hidden"),boxMarkdown.style.width="100%",boxMarkdown.style.height="100vh"}),mode3.addEventListener("click",function(e){e.preventDefault(),setCurrentMode(mods,3),boxHtml.classList.contains("visually-hidden")&&boxHtml.classList.remove("visually-hidden"),boxResult.classList.contains("visually-hidden")&&boxResult.classList.remove("visually-hidden"),handler1.classList.contains("visually-hidden")&&handler1.classList.remove("visually-hidden"),handler2.classList.contains("visually-hidden")&&handler2.classList.remove("visually-hidden"),boxMarkdown.style.width="33%",boxResult.style.width="33%",boxHtml.style.width="33%",boxMarkdown.style.height="auto"});
